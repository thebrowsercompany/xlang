## SwiftCodeGen: Proof of concept C-based WinRT bindings

This tool generates Swift code that can interop with "classic" header files generated by MIDL (or abi.exe) to support a *small* subset of WinRT. It's based on hand-written code from: https://github.com/compnerd/SwiftWinRT

**Note: the approach we prefer is to use https://github.com/compnerd/swift-winmd to go directly from .winmd to idiomatic Swift, with no intermediate C layer and minimal hand-written code. This is to unblock other investigations and prototyping.**

That small subset aligns with what ArcCoreDemoWin needs to host ArcCore.dll (Chromium) and core objects, up to the point of hosting the WebContents HWND and doing basic navigation.

On top of the generated code, to be more usable from Swift, another level is useful that's not yet generated but likely could be -- at least mostly. Some examples are below, with a pattern that might make sense but hasn't been fully thought out.

```
// Instantiating a new WinRT object
public class BrowserApplicationConfiguration {
  internal var interface: IBrowserApplicationConfiguration

  public init() {
    try! interface = RoActivateInstance(HString("ArcCoreWinRT.BrowserApplicationConfiguration"))
  }

  public func initialize(_ profilePath: String) {
    try! interface.initialize(HString(profilePath).hRef.hString)
  }
}

// Wrapping a WinRT object returned from an API call and not directly activated
public class Browser {
  internal var interface: IBrowser

  public init(_ fromInterface: IBrowser) {
    interface = fromInterface
  }

  // An example way to wrap, where 'WebContents' is structured just like this class.
  public func createWebContents(_ configuration: WebContentsConfiguration) -> WebContents {
    var webContentsInterface: UnsafeMutablePointer<__x_ABI_CArcCoreWinRT_CIWebContents>?
    try! interface.createWebContents(RawPointer(configuration.interface), &webContentsInterface)
    return WebContents(IWebContents(consuming: webContentsInterface))
  }

  public func close() {
    try! interface.close()
  }
}
```

## Usage

`swiftcodegen.exe -ns-prefix -input d:\workspace\chromium\src\out\debug\gen\Arc\ArcCoreWin.winmd -output d:\some\outputdir -reference sdk`

You can also reference single .winmd files, with the required one being: `-reference "C:\Program Files (x86)\Windows Kits\10\References\10.0.19041.0\Windows.Foundation.FoundationContract\4.0.0.0\Windows.Foundation.FoundationContract.winmd"`. Response files should also be supported.